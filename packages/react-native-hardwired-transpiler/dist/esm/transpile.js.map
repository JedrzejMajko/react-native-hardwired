{"version":3,"file":"transpile.js","names":["path","require","bundler","transformHelpers","module","exports","cliOptions","entryFile","resolve","file","mainPath","options","oldConsoleWarn","console","warn","oldConsoleLog","process","stdout","write","_bundler","_deltaBundler","config","resolverOptions","transformOptions","deps","getResolveDependencyFn","platform","dt","getTransformFn","transpiled"],"sources":["../../src/transpile.js"],"sourcesContent":["/*\n * Copyright (c) 2023 JÄ™drzej Majko (jdrzjm@gmail.com)\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nconst path = require('path');\nconst bundler = require('./utils/bundler.js');\nconst transformHelpers = require('metro/src/lib/transformHelpers');\n\nmodule.exports = async (cliOptions) => {\n  const entryFile = path.resolve(cliOptions.file);\n  const mainPath = cliOptions.mainPath;\n  const options = {};\n\n  /**\n   * Blocks Metro from printing warnings to console\n   * @type {{(message?: any, ...optionalParams: any[]): void, (...data: any[]): void}}\n   */\n  const oldConsoleWarn = console.warn;\n  const oldConsoleLog = process.stdout.write;\n  console.warn = function () {};\n  process.stdout.write = function () {};\n\n  const { _bundler, _deltaBundler, config } = await bundler(options, mainPath);\n\n  const resolverOptions = {};\n  const transformOptions = {};\n\n  const deps = await transformHelpers.getResolveDependencyFn(\n    _bundler,\n    transformOptions.platform,\n    resolverOptions\n  );\n\n  const dt = await transformHelpers.getTransformFn(\n    [entryFile],\n    _bundler,\n    _deltaBundler,\n    config,\n    transformOptions,\n    resolverOptions\n  );\n\n  const transpiled = await dt(entryFile);\n\n  console.warn = oldConsoleWarn;\n  process.stdout.write = oldConsoleLog;\n\n  return { transpiled: transpiled, entryFile: entryFile, deps: deps };\n};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAMC,OAAO,GAAGD,OAAO,CAAC,oBAAoB,CAAC;AAC7C,MAAME,gBAAgB,GAAGF,OAAO,CAAC,gCAAgC,CAAC;AAElEG,MAAM,CAACC,OAAO,GAAG,MAAOC,UAAU,IAAK;EACrC,MAAMC,SAAS,GAAGP,IAAI,CAACQ,OAAO,CAACF,UAAU,CAACG,IAAI,CAAC;EAC/C,MAAMC,QAAQ,GAAGJ,UAAU,CAACI,QAAQ;EACpC,MAAMC,OAAO,GAAG,CAAC,CAAC;;EAElB;AACF;AACA;AACA;EACE,MAAMC,cAAc,GAAGC,OAAO,CAACC,IAAI;EACnC,MAAMC,aAAa,GAAGC,OAAO,CAACC,MAAM,CAACC,KAAK;EAC1CL,OAAO,CAACC,IAAI,GAAG,YAAY,CAAC,CAAC;EAC7BE,OAAO,CAACC,MAAM,CAACC,KAAK,GAAG,YAAY,CAAC,CAAC;EAErC,MAAM;IAAEC,QAAQ;IAAEC,aAAa;IAAEC;EAAO,CAAC,GAAG,MAAMnB,OAAO,CAACS,OAAO,EAAED,QAAQ,CAAC;EAE5E,MAAMY,eAAe,GAAG,CAAC,CAAC;EAC1B,MAAMC,gBAAgB,GAAG,CAAC,CAAC;EAE3B,MAAMC,IAAI,GAAG,MAAMrB,gBAAgB,CAACsB,sBAAsB,CACxDN,QAAQ,EACRI,gBAAgB,CAACG,QAAQ,EACzBJ,eACF,CAAC;EAED,MAAMK,EAAE,GAAG,MAAMxB,gBAAgB,CAACyB,cAAc,CAC9C,CAACrB,SAAS,CAAC,EACXY,QAAQ,EACRC,aAAa,EACbC,MAAM,EACNE,gBAAgB,EAChBD,eACF,CAAC;EAED,MAAMO,UAAU,GAAG,MAAMF,EAAE,CAACpB,SAAS,CAAC;EAEtCM,OAAO,CAACC,IAAI,GAAGF,cAAc;EAC7BI,OAAO,CAACC,MAAM,CAACC,KAAK,GAAGH,aAAa;EAEpC,OAAO;IAAEc,UAAU,EAAEA,UAAU;IAAEtB,SAAS,EAAEA,SAAS;IAAEiB,IAAI,EAAEA;EAAK,CAAC;AACrE,CAAC"}